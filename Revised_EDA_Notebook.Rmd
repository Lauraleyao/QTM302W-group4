---
title: "QTM302W: EDA on Quarterly Data for Macroeconomic Research"
author: "Laura Wang, Sean Jeon, Yuting Chen, Kari Zhou"
date: "2025-12-11"
output: html_document
---

```{r setup, include=FALSE}
if (!dir.exists("figures")) {
  dir.create("figures")
}

knitr::opts_chunk$set(echo = TRUE, fig.path = "figures/")

library(tidyverse)
library(lubridate)
library(patchwork)
library(corrplot)
library(ggplot2)
library(dplyr)
library(tidyr)
library(zoo)
library(scales)
```

# 0\. Introduction
This notebook represents the quantitative foundation of our larger research project, “**Resilience and Recovery: Tracing the U.S. Economic Trajectory (2000–2025).**” While our broader project examines the housing activity and policy implications behind the economic shock, this analysis provides the empirical evidence necessary to validate those narratives of how the key economic variables and housing indicators are correlated and fluctuated from 2000 to 2025.

We draw on the **FRED-QD (Federal Reserve Economic Data – Quarterly Data)** dataset, a comprehensive macroeconomic database maintained by the Federal Reserve Bank of St. Louis. This dataset includes U.S. economy data from the Bureau of Economic Analysis (BEA) and the Bureau of Labor Statistics (BLS), including core categories such as output, consumption, investment, government spending, trade, and housing. 

Although the dataset covers a long time period since the 1960s, we focused on data from **2000 to 2025**, and using that to examine the long-run economic trends and cyclical fluctuations. This period experienced three distinct economic shocks:  the Great Recession, the Trade War, and the COVID-19 pandemic. The purpose of this exploratory analysis is to:

1. **Investigate the evolution of Gross Domestic Product (GDP) and its major components**, emphasizing how domestic activity and external trade dynamics contribute to overall economic performance.

2. **Isolate Housing Indicators** as a leading signal of broader economic health.

3. **Investigate Policy Impacts**, specifically on the relationship between interest rates,  government spending and private investment.

The dataset poses minimal ethical concerns as it consists entirely of publicly available, aggregate economic statistics that contain no individual-level or proprietary information. Our analysis therefore centers on responsible interpretation, transparency in data handling, and reproducible economic insights derived from public data.
This analysis adheres to reproducible research standards, relying entirely on public, aggregate statistics with no ethical concerns regarding individual privacy.

# 1\. Preparing the Foundation: Data Cleaning and Formatting

Before we can interpret economic signals, we must clean the raw FRED-QD dataset since it contains metadata rows that must be stripped out to prevent parsing errors.


In the code chunk:
1. **Loading Data and Removing Rows**: We load the Federal Reserve Economic Quarterly Data file titled 2025-09-QD.csv and remove the transformation code row (row 2) to align the dataset.
2.  **Formatting**: Then, we renamed the 'sasdate' to 'date,' and format the time index to a standard `month-day-year` format. We convert all data columns into numeric types and coercing errors to NA values.
3.  **Filtering**: Since we are only interested in data from January 2000 to August 2025, we restrict the sample to the time window of interest and only focus on the modern economic cycle.

<!-- end list -->

```{r}
data <- read.csv("data/2025-09-QD.csv")
data <- data[-1, ] 

names(data)[1] <- "date"
data$date <- as.Date(data$date, "%m/%d/%Y")

data <- data %>%
  mutate(across(-date, ~as.numeric(as.character(.))))

startSample <- as.Date("2000-01-01")
endSample   <- as.Date("2025-08-01")

df <- data %>%
  filter(date >= startSample & date <= endSample)
```

# 2\. Snapshot of the Economy: Descriptive Statistics

To ground our analysis, we establish a baseline of central tendencies and volatility by creating a summarization table including key variables for the U.S. economy.  

By examining the mean, standard deviation, and range of indicators like **GDP (GDPC1)**, **components of GDP (Consumption, Investment, Government Spending, Import, and Export)**, **Housing Starts (HOUST)**, **Federal Funds Rate (FEDFUNDS)**, **House Price Index (USSTHPI)**, and **Disposable Income (DPIC96)**,  we are able verify data quality and understand the typical magnitudes of these economic drivers before visualizing their fluctuations from 2000 to 2025. 


```{r}
vars_to_summarize <- c("GDPC1", "PCECC96", "GPDIC1", "GCEC1", "HOUST", 
                       "MORTGAGE30US", "FEDFUNDS", "UMCSENTx", "USSTHPI", "DPIC96")

get_stats <- function(x) {
  c(
    N = length(x) - sum(is.na(x)), # Count of non-missing values
    Mean = mean(x, na.rm = TRUE),
    StDev = sd(x, na.rm = TRUE),
    Min = min(x, na.rm = TRUE),
    Median = median(x, na.rm = TRUE),
    Max = max(x, na.rm = TRUE)
  )
}

summary_matrix <- sapply(df[vars_to_summarize], get_stats)
summary_table <- t(summary_matrix)

readable_names <- c("GDP", "Consumption", "Investment", "Gov. Spend", 
                    "Housing Starts", "Mortgage Rate", "Fed Funds Rate", 
                    "Sentiment", "House Price Idx", "Disp. Income")

rownames(summary_table) <- readable_names

knitr::kable(summary_table, 
             digits = 2, 
             caption = "Descriptive Statistics for Key Variables (2000-2025)")
```

From the descriptive statistics table, we are able to see that the dataset from 2000 to 2025 contains 102 quarterly observations for each variable.

GDP averages 18,159.50 with a standard deviation of 2,755.27, showing steady growth and moderate fluctuation over time. Consumption (mean = 12,252.71) follows a similar trend but with slightly less variation. Investment and government spending average 3,088.39 and 3,408.44, respectively, with spending showing more stability than investment.

Housing starts show high volatility, ranging from 525.67 to 2,120.33, reflecting the cyclical nature of the housing market. The mortgage rate averages 5.18%, while the federal funds rate averages 1.97%, highlighting periods of low interest rates after 2008 and during COVID-19. Consumer sentiment (mean = 82.42) and the house price index (mean = 406.65) both indicate overall recovery and growth since the early 2000s. Finally, disposable income averages 13,531.19, closely tracking GDP and consumption trends.

Overall, the statistics show that key macroeconomic indicators moved together over the past 25 years, with notable fluctuations in housing and monetary policy variables.

# 3\. Decomposing Growth: The Changing Composition of GDP

Gross Domestic Product is more than a single number; it is the sum of consumption, investment, government spending, and net exports (export - import).

In this section, we calculated the proportion each component takes of the total GDP, and visualized them using a line chart to show the trends over time, and a stacked area chart to show the relative weight of each component of GDP. In addition to plotting the components of GDP, we also added three grey dashed line to indicate the time of our interest, 2008 Global Financial Crisis, 2018 Trade War, and the COVID-19 pandemic. 

```{r gdp_proportion}
df <- df %>%
  mutate(
    C_proportion = PCECC96 / GDPC1,
    I_proportion = GPDIC1 / GDPC1,
    G_proportion = GCEC1 / GDPC1,
    X_proportion = EXPGSC1 / GDPC1,
    M_proportion = IMPGSC1 / GDPC1,
    NX_proportion = (EXPGSC1 - IMPGSC1) / GDPC1
  )

# Plot 1: Line chart for absolute trend analysis
p_value_line_all <- ggplot(df, aes(x = date)) +
  geom_line(aes(y = PCECC96, color = "Consumption"), size=1) +
  geom_line(aes(y = GPDIC1, color = "Investment"), size=1) +
  geom_line(aes(y = GCEC1, color = "Gov. Spending"), size=1) +
  # Add vertical lines to mark major crises for context
  geom_vline(xintercept = as.Date("2008-09-01"), linetype="dashed", color="gray50") +
  geom_vline(xintercept = as.Date("2018-07-01"), linetype="dashed", color="gray50") +
  geom_vline(xintercept = as.Date("2020-03-01"), linetype="dashed", color="gray50") +
  labs(title = "Total Value of GDP Components (2000-2025)", 
       subtitle = "Dashed lines indicate 2008 Crisis, 2018 Trade War, and 2020 Pandemic Start",
       y = "Billions of Chained Dollars", x = "Date") +
  scale_y_continuous(labels = scales::dollar) +
  scale_color_manual(name = "Component", values = c("Consumption" = "#1f77b4",
                                                    "Investment" = "#d62728", 
                                                    "Gov. Spending" = "#2ca02c")) +
  theme_minimal() +
  theme(legend.position = "bottom")

p_value_line_all

# Plot 2: Stacked area chart for structural composition
p_proportions_area_full <- df %>%
  select(date, C_proportion, I_proportion, G_proportion, NX_proportion) %>%
  pivot_longer(cols = -date, names_to = "component", values_to = "proportion") %>%
  ggplot(aes(x = date, y = proportion, fill = component)) +
  geom_area(alpha=0.8) +
  labs(title = "Structural Composition of U.S. GDP", 
       y = "Proportion of GDP", x = "") +
  scale_y_continuous(labels = scales::percent) +
  scale_fill_manual(name = "Component", 
                    values = c("C_proportion"="#7fc97f", "I_proportion"="#beaed4", 
                               "G_proportion"="#fdc086", "NX_proportion"="#ffff99"),
                    labels = c("Consumption", "Gov. Spending", "Investment", "Net Exports")) +
  theme_minimal()
  
p_proportions_area_full
```
The first figure shows that consumption clearly dominates the GDP’s portion, rising steadily from about $9 trillion to over $16 trillion, reflecting its central role in driving U.S. economic growth. Investment and government spending both trend upward but remain at lower magnitudes. Investment exhibits more cyclical movement, with sharp declines during the 2008 financial crisis and 2020 COVID-19 recession, while government spending remains relatively stable, often increasing slightly during downturns to make up the economic depression. Exports and imports both grow over time, with imports consistently exceeding exports, indicating a persistent trade deficit of the US economy.

By visualizing the weight of each component of GDP, the second figure shows that the share of consumption consistently accounts for the largest portion, roughly 65–70% of GDP, showing remarkable stability over the past 25 years. Investment and government spending together make up about 25–30%, while net exports remain negative, slightly reducing overall GDP. Despite economic shocks, the proportional structure of GDP has remained largely constant, demonstrating the long-term resilience and consumer-driven nature of the U.S. economy.


# 4\. Interdependencies: The Correlation Matrix

Variables affects the economy may also have influence on other things, like the mortgage rate, federal funds rate, and even housing starts and the house price index. To get a sense of how these economic variables may impact other variables, we construct a correlation matrix to quantify the strength of linear relationship between our key variables. 


```{r heatmap}
selected_vars <- df %>%
  select(GDPC1, PCECC96, GPDIC1, GCEC1, HOUST, MORTGAGE30US, FEDFUNDS, UMCSENTx, USSTHPI, DPIC96)

readable_names <- c("GDP", "Consumption", "Investment", "Gov. Spend", "Housing Starts", 
                    "Mortgage Rate", "Fed Funds Rate", "Sentiment", "House Price Idx", "Disp. Income")

cor_matrix <- cor(selected_vars, use = "pairwise.complete.obs")
colnames(cor_matrix) <- readable_names
rownames(cor_matrix) <- readable_names

# Visualizing the matrix
corrplot(cor_matrix, method = "color", 
         type = "upper", 
         order = "hclust", 
         addCoef.col = "black", tl.col = "black", 
         tl.srt = 45, diag = FALSE, 
         number.cex = 0.7, 
         title = "Correlation Matrix of Key Economic Variables", mar=c(0,0,1,0))
```

The most prominent pattern is the strong positive correlation among GDP, consumption, investment, and disposable income, all with coefficients above 0.9. This confirms that these core components of economic activity tend to rise and fall together, reflecting their shared dependence on overall economic growth. Government spending is also positively correlated with these variables, though slightly less strongly, which makes sense since fiscal policy often responds countercyclically, rising during downturns and moderating during expansions.

By contrast, housing-related indicators and interest rates display weaker and sometimes negative relationships with output measures. For instance, housing starts and consumer sentiment are negatively correlated with government spending (around –0.6), implying that when government expenditure is high, often during recessions, housing activity and confidence tend to be lower. Mortgage rates and the federal funds rate show moderate positive correlations with each other (about 0.82), as expected, but are weakly related to GDP and consumption. This suggests that short-term rate changes alone do not strongly determine overall output within the period examined. These negative correlations will be explored further in the final scatterplots of the report.

The correlation matrix highlights strong positive relationships among GDP, consumption, investment, and disposable income, all of which move closely together as core drivers of economic activity. Government spending also shows positive but slightly weaker correlations, reflecting its countercyclical behavior. Housing indicators and interest rates display weaker and sometimes negative links with output measures. For example, housing starts and consumer sentiment are negatively correlated with government spending, suggesting that higher spending often occurs during weaker and unstable economic periods. Mortgage and federal funds rates correlate moderately with each other but only weakly with GDP or consumption. Overall, the matrix underscores that income, consumption, and investment dominate economic fluctuations, while fiscal and monetary variables influence activity more indirectly.

# 5\. Testing Economic Theory: Trade and Rational Actors

We have looked at the broad trends for the major indicators. Now we need to drill down into specific relationships to see if the data behaves the way economic theory says it should. We want to test three specific stories about the economy. We want to know if trade deficits react to policy changes. We want to see if businesses actually stop investing when interest rates go up. And finally we want to see if consumer feelings actually predict their spending.

**The Trade Gap**

First we look at the balance of trade. The chart below tracks Real Exports in dark blue against Real Imports in orange. We have added shaded regions to mark the 2019 Trade War and the policy adjustments in 2025. We wanted to see if political interventions successfully shrank the gap between what we buy and what we sell.

The data suggests that the deficit is stubborn. While the 2020 shock caused both lines to drop briefly, the gap reasserted itself almost immediately. This suggests that tariff policies have not fundamentally changed the American appetite for foreign goods.

```{r the_trade_gap}
ggplot(data = df, aes(x = date))+
  geom_line(aes( y = EXPGSC1, color = "Export"), size=1)+
  geom_line(aes(y = IMPGSC1, color = "Import"), size=1)+
  geom_line(aes(y = GDPC1, color = "GDP"), size=1.2, alpha=0.5)+ 
  scale_color_manual(values = c("Export" = "darkblue", 
                                "Import" = "orange",
                                "GDP" = "gray70" 
                               )) +
  # Highlight Tariff Policy Periods
  annotate("rect", fill = "red", alpha = 0.1, 
           xmin = as.Date(c("2019-01-01")), xmax = as.Date(c("2019-06-30")),
           ymin = -Inf, ymax = Inf) +
  annotate("text", x = as.Date("2019-04-01"), y = 25000, label="Trade War", angle=90, vjust=1.5, size=3) +
  
  annotate("rect", fill = "red", alpha = 0.1, 
           xmin = as.Date(c("2025-04-02")), xmax = as.Date(c("2025-09-01")),
           ymin = -Inf, ymax = Inf) +
    annotate("text", x = as.Date("2025-06-01"), y = 25000, label="Policy Adj.", angle=90, vjust=1.5, size=3) +
  
  labs(color = "Metric",
       title = "The Widening Gap: Imports vs. Exports",
       subtitle = "Shaded regions indicate periods of active tariff policy changes",
       x = "Year",
       y = "Billions of Dollars") +
  theme_minimal() +
  theme(legend.position = "top")
```

**Rational Actors and Investment**

Next we check the textbook definitions of rational behavior. We constructed three scatterplots to visualize these relationships.

The top left plot compares the Federal Funds Rate to Real Investment. Standard theory says high rates should kill investment. Our data shows a cloud with no clear direction. This implies that businesses invest based on long term demand rather than just the immediate cost of borrowing.

The top right plot compares Consumer Sentiment to Real Consumption. We expected a strong positive line. The data is messy here as well. People sometimes say they are pessimistic but they continue to shop anyway.

The bottom plot compares Disposable Income to Consumption. This relationship is crystal clear. The points form a tight diagonal line. This tells us that income is the single best predictor of economic activity. If people have money then they spend it.

```{r rational_behaviors}
# Plot A: Interest Rates vs Investment
p_scatter_investment <- ggplot(df, aes(x = FEDFUNDS, y = GPDIC1)) +
  geom_point(alpha = 0.6, color = "darkgreen") + 
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  labs(title = "Policy Inelasticity", 
       subtitle = "Fed Funds Rate vs. Real Investment",
       x = "Federal Funds Rate (%)", y = "Real Investment (Billions)") + 
  theme_minimal()

# Plot B: Sentiment vs Consumption
p_scatter_sentiment <- ggplot(df, aes(x = UMCSENTx, y = PCECC96)) +
  geom_point(alpha = 0.6, color = "darkblue") + 
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  labs(title = "The Sentiment Paradox", 
       subtitle = "Consumer Sentiment vs. Real Consumption",
       x = "Consumer Sentiment Index", y = "Real Consumption (Billions)") + 
  theme_minimal()

# Plot C: Income vs Consumption
p_scatter_income <- ggplot(df, aes(x = DPIC96, y = PCECC96)) +
  geom_point(alpha = 0.6, color = "purple") + 
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  labs(title = "The Income Driver", 
       subtitle = "Real Disposable Income vs. Real Consumption",
       x = "Real Disposable Income", y = "Real Consumption") + 
  theme_minimal()

combined_plot <- (p_scatter_investment + p_scatter_sentiment) / p_scatter_income
combined_plot + plot_annotation(
  title = "Drivers of Economic Activity (2000 to 2025)",
  caption = "Source: FRED-QD | Top row: Weak Correlations. Bottom row: Strong Positive Correlation.",
  theme = theme(plot.title = element_text(size = 16, face = "bold"))
)
```

# 6\. Housing as a Leading Indicator

Housing is physical and capital intensive. This makes it a great signal for the broader economy. We wanted to see if the recovery in housing was uniform across the country or if specific regions were driving the growth.

**The Regional Split**

We broke down housing starts by census region. The result invalidates the idea of a single national housing market. The Teal line representing the South is doing all the heavy lifting. The Northeast and Midwest have been flat for twenty years. The South has exploded. This is likely due to demographic shifts and land availability rather than national monetary policy.

```{r housing_starts_southern}
ggplot(data = df, aes(x = date))+
  geom_line(aes(y = HOUST, color = "Nation Total"), linetype="dotted", alpha=0.5) +
  geom_line(aes(y = HOUSTMW, color = "Midwest")) +
  geom_line(aes(y = HOUSTNE, color = "Northeast")) +
  geom_line(aes(y = HOUSTS, color = "South"), size=1.1) + # Emphasize South
  geom_line(aes(y = HOUSTW, color = "West"))+
  scale_color_manual(values = c("Nation Total" = "gray", 
                                "Midwest" = "orange", 
                                "Northeast" = "red",
                                "South" = "darkcyan", # Highlight color
                                "West" = "pink")) +
  labs(color = "Region",
       title = "New Housing Starts: The Southern Expansion",
       subtitle = "The South (Teal) drives the majority of housing volume",
       x = "Year",
       y = "Units (Thousands)") +
  theme_minimal()
```

**Smoothing the Volatility**

Housing data is noisy. Bad weather in February can look like a recession in the raw numbers. We applied a 6 month rolling average to find the signal in the noise. The blue trend line reveals the cycle clearly. We see the massive crash in 2008 and the slow grind upward for a decade. We also see the chaotic spike of the pandemic era and the current cool down.

```{r housing_starts_w_6months_average}
df <- df %>%
  mutate(MA_6month = zoo::rollmean(PERMIT, k = 6, fill = NA, align = "right"))

ggplot(df, aes(x = date)) +
  geom_line(aes(y = HOUST, color = "Raw Data (Monthly)"), alpha=0.4) +
  geom_line(aes(y = MA_6month, color = "6 Month Trend"), size = 1.2) +
  labs(title = "Smoothing the Cycle", 
       subtitle = "National Housing Starts with 6 Month Moving Average",
       x = "Date", y = "Units (Thousands)") +
  scale_color_manual(values = c("Raw Data (Monthly)" = "gray50", "6 Month Trend" = "blue")) +
  theme_minimal() +
  theme(legend.position = "bottom")
```

**The Fiscal Relationship**

Finally we checked the relationship between Government Spending and Housing Starts. The correlation is negative. This might look like the government is crowding out private builders. The reality is likely different. The government usually spends money on stimulus packages exactly when the private sector is collapsing. The negative correlation is a sign of reactive policy.

```{r govtspending_vs_housing_starts}
p_scatter_houst_gov <- ggplot(df, aes(x = GCEC1, y = HOUST)) +
  geom_point(alpha = 0.7, color = "darkcyan") +
  geom_smooth(method = "lm", se = FALSE, color = "black", linetype = "dashed") +
  labs(title = "Fiscal Counter Cyclicality", 
       x = "Real Gov. Spending", y = "Housing Starts") +
  theme_minimal()

p_scatter_houst_gov
```

# 7\. Conclusion

We spent this notebook exploring the contours of the American economy from 2000 to 2025. This process has clarified the structure of our dataset and pointed us toward specific research questions.

We found that consumption is the anchor of the US economy. It remained stable through the 2008 crash and the pandemic lockdowns. We found that this stability is tied tightly to disposable income. This suggests that future research should focus on income growth rather than consumer confidence surveys.

We also discovered that geography matters. The recovery in housing starts is entirely a story about the South. Research that treats the US as a single housing market will miss the mark.

Finally we saw that policy is reactive. The negative link between government spending and housing starts confirms that fiscal expansion usually happens only after the private sector has slowed down.

**Future Work**

This exploratory analysis showed us what happened. The next step is to understand why. The most confusing finding was the lack of correlation between interest rates and investment. We know rates matter. But the effect is not immediate. Our future work will use Vector Autoregression models to measure the time lag between a rate hike and a drop in investment. This will help us understand the causal timeline of economic recovery.

# 8\. Works Cited

Michael W. McCracken and Serena Ng. “FRED-QD: A Quarterly Database for Macroeconomic Research.” Federal Reserve Bank of St. Louis Review, First Quarter 2021. [https://doi.org/10.20955/r.103.1-44](https://doi.org/10.20955/r.103.1-44)

Fred-MD and Fred-QD: Monthly and quarterly databases for Macroeconomic Research. Federal Reserve Bank of St. Louis. [https://www.stlouisfed.org/research/economists/mccracken/fred-databases](https://www.stlouisfed.org/research/economists/mccracken/fred-databases)